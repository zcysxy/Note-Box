# Python Functions - open

[[Python Functions]]

* `open(filename,[mode],[encoding],[newline])`
* 函数返回的是一个 **TextIOWrapper** 对象, 有 `.read()`, `.write()` 等文本操作方法
    * 此对象为[[Python Types - Iterable|可迭代对象]], 元素即为**每行**作为一个字符串
    * 故可以直接用 open 函数 "读取" 文件, 如:

        ```py
        for eachline in open(file):
            print(eachline)
        ```

* *filename* 应为文件**路径**的**字符串**, 不是绝对路径时默认为程序文件所在目录的相对路径
    * 绝对路径形如 `D:\\..`
    * 文件对**后缀**无要求, 只对内容 (文本文件或二进制文件) 有要求
        * ==文件后缀主要是供**操作系统**选择默认打开程序, 而在程序打开文件时没有影响==
* 可选参数 *mode* 指定文件的打开方式
    * *mode* 可选值如下:

        | 值  | 描述                                |
        |-----|------------------------------------|
        | 'r' | 读模式 (**默认模式**)                 |
        | 'w' | 写模式                              |
        | 'a' | 追加模式                            |
        | 'x' | 创建模式                            |
        | 'b' | 二进制模式 (可与前四种模式并用)         |
        | 't' | 文本模式 (**默认**, 可与前四种模式并用) |
        | '+' | 读,写模式 (可与其他模式并用)           |

        * 读模式 ('r') 在文件 *filename* 不存在时报错; 存在时打开该文件
        * 写模式 ('w') 在文件 *filename* 不存在时创建同名**空文件**; 存在时**清空**该文件内容
        * 追加模式 ('a') 在文件 *filename* 不存在时创建同名**空文件**; 存在时在该文件尾部追加内容
        * 创建模式 ('x') 在文件 *filename* 不存在时创建同名**空文件**; 存在时**报错**

!! 可选参数 *newline* 和 *encoding* 前还有其他可选参数, 故只要调用它们的话要用语法: `newline =` 和 `encoding =`

* 可选参数 *encoding* 指定文件编码方式, 一般为 "utf-8"
* 可选参数 *newline* 只在**文本模式**下生效, 决定如何读取和返回文本文件中的**换行符**, 主要影响 `.readline()`, `.writeline()` 等方法
    * *newline* 可选值如下

|   值   | 描述                             |
|:------:|---------------------------------|
| *None* | 即**默认**, 此时为 **universal newlines mode**, 识别 '\n', '\r', '\r\n' 为换行符, **统一**返回 '\n' |
| ''     | **universal newlines mode**, 识别 '\n', '\r', '\r\n' 为换行符, 直接返回原符号 |
|  '\n'  | 识别 '\n' 为换行符, 直接返回原符号   |
|  '\r'  | 识别 '\r' 为换行符, 直接返回原符号   |
| '\r\n' | 识别 '\r\n' 为换行符, 直接返回原符号 |

/! 系统换行符

官方文档说:

> When writing output to the stream, if newline is None, any '\n' characters written are translated to the system default line separator, os.linesep.

但是实际上换行符都被转换成了 '\n', 而模块 [[Python Modules - os|os]] 中的 `os.linesep` 为 '\r\n'

!/

[//begin]: # "Autogenerated link references for markdown compatibility"
[Python Functions]: Python Functions "Python Functions"
[//end]: # "Autogenerated link references"